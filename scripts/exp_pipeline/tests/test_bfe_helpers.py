import sys
import numpy as np
sys.path.append("../")
from compute_bfe_helpers import load_sheng24_exp_center

def test_load_sheng24_exp_center():
    SIM_ID = 108 
    DATAPATH = "../../../suites/Sheng24/orbits/"
    FILENAME = "MW_LMC_orbits_iso.txt"
    NSNAPS = 101
    SIM_PARAMS_FILE = 'MW_LMC_orbits_iso.txt'
    centers = load_sheng24_exp_center(
                                DATAPATH, 
                                FILENAME,
                                sim_id=SIM_ID,
                                return_vel=True)

    times = centers[0]
    rmw = centers[1]
    vmw = centers[2]
    rlmc = centers[3]
    vlmc = centers[4]

    t_sim =	np.array([0.  , 0.02, 0.04, 0.06, 0.08, 0.1 , 0.12, 0.14, 0.16, 0.18, 0.2 ,
        0.22, 0.24, 0.26, 0.28, 0.3 , 0.32, 0.34, 0.36, 0.38, 0.4 , 0.42,
        0.44, 0.46, 0.48, 0.5 , 0.52, 0.54, 0.56, 0.58, 0.6 , 0.62, 0.64,
        0.66, 0.68, 0.7 , 0.72, 0.74, 0.76, 0.78, 0.8 , 0.82, 0.84, 0.86,
        0.88, 0.9 , 0.92, 0.94, 0.96, 0.98, 1.  , 1.02, 1.04, 1.06, 1.08,
        1.1 , 1.12, 1.14, 1.16, 1.18, 1.2 , 1.22, 1.24, 1.26, 1.28, 1.3 ,
        1.32, 1.34, 1.36, 1.38, 1.4 , 1.42, 1.44, 1.46, 1.48, 1.5 , 1.52,
        1.54, 1.56, 1.58, 1.6 , 1.62, 1.64, 1.66, 1.68, 1.7 , 1.72, 1.74,
        1.76, 1.78, 1.8 , 1.82, 1.84, 1.86, 1.88, 1.9 , 1.92, 1.94, 1.96,
        1.98, 2.  ])

    ymw = np.array([ 0.  ,  0.03,  0.04,  0.06,  0.07,  0.07,  0.08,  0.08,  0.09,
        0.11,  0.13,  0.14,  0.15,  0.18,  0.2 ,  0.23,  0.3 ,  0.37,
        0.41,  0.47,  0.51,  0.58,  0.62,  0.74,  0.81,  0.88,  0.92,
        0.95,  1.05,  1.09,  1.18,  1.23,  1.32,  1.4 ,  1.5 ,  1.64,
        1.72,  1.84,  1.93,  2.08,  2.19,  2.32,  2.46,  2.56,  2.73,
        2.87,  3.06,  3.18,  3.38,  3.51,  3.72,  3.89,  4.01,  4.17,
        4.28,  4.44,  4.55,  4.76,  4.9 ,  5.17,  5.42,  5.61,  5.89,
        6.09,  6.4 ,  6.57,  6.86,  7.14,  7.36,  7.65,  7.86,  8.2 ,
        8.44,  8.81,  9.05,  9.45,  9.9 , 10.19, 10.62, 10.94, 11.43,
        11.75, 12.27, 12.6 , 13.08, 13.54, 13.88, 14.4 , 14.75, 15.27,
        15.6 , 16.09, 16.59, 16.93, 17.42, 17.75, 18.2 , 18.51, 18.92,
        19.13, 19.41])

    vymw = np.array([ 0.  ,  0.21,  0.31,  0.28,  0.73,  0.83,  0.79,  0.85,  0.75,
        1.02,  1.37,  1.4 ,  1.53,  1.76,  1.98,  2.12,  2.22,  2.48,
        2.69,  2.88,  3.11,  3.16,  3.14,  3.1 ,  3.12,  3.28,  3.47,
        3.6 ,  3.77,  3.97,  4.1 ,  4.18,  4.39,  4.54,  4.7 ,  4.87,
        5.16,  5.5 ,  5.64,  5.82,  6.16,  6.39,  6.72,  6.81,  6.98,
        7.11,  7.18,  7.14,  7.21,  7.5 ,  7.74,  7.92,  8.12,  8.18,
        8.32,  8.93,  9.15,  9.63,  9.93, 10.28, 10.77, 10.96, 11.44,
        11.94, 12.58, 12.89, 13.38, 13.92, 14.08, 14.19, 14.56, 15.16,
        15.4 , 15.86, 16.38, 16.77, 17.43, 17.91, 18.79, 19.28, 19.58,
        20.03, 20.61, 20.97, 21.41, 21.81, 22.07, 22.2 , 22.48, 22.58,
        22.69, 22.66, 22.25, 21.77, 20.93, 20.07, 18.43, 16.97, 14.96,
        13.2 , 10.64])

    ylmc = np.array([334.84, 331.8 , 329.77, 326.67, 324.63, 321.58, 319.57, 316.48,
        314.41, 311.28, 308.17, 306.09, 302.96, 300.89, 297.74, 295.63,
        292.45, 289.24, 287.1 , 283.89, 281.72, 278.41, 276.2 , 272.87,
        270.64, 267.29, 263.93, 261.68, 258.32, 256.08, 252.67, 250.36,
        246.89, 244.55, 241.04, 237.46, 235.06, 231.49, 229.1 , 225.5 ,
        223.11, 219.46, 215.77, 213.31, 209.61, 207.12, 203.35, 200.84,
        196.97, 194.38, 190.45, 186.49, 183.83, 179.87, 177.19, 173.14,
        170.43, 166.34, 163.59, 159.39, 155.16, 152.28, 147.92, 145.  ,
        140.57, 137.61, 133.13, 128.6 , 125.58, 120.97, 117.86, 113.13,
        109.96, 105.11, 101.84,  96.89,  91.88,  88.51,  83.37,  79.92,
        74.63,  71.05,  65.63,  61.97,  56.4 ,  50.76,  46.99,  41.21,
        37.33,  31.41,  27.45,  21.49,  15.48,  11.5 ,   5.58,   1.69,
        -4.03,  -7.76, -13.15, -16.61, -21.56])

    vylmc = np.array([-128.55, -129.2 , -129.27, -130.08, -130.45, -130.68, -131.02,
        -131.72, -132.33, -132.94, -133.56, -133.8 , -134.42, -134.74,
        -135.36, -135.93, -136.23, -137.09, -137.64, -138.38, -139.03,
        -140.24, -140.82, -141.76, -142.47, -142.72, -143.44, -143.81,
        -144.35, -145.47, -146.7 , -147.52, -148.54, -149.17, -150.63,
        -151.93, -152.41, -153.01, -153.6 , -154.84, -155.66, -156.86,
        -158.39, -159.16, -160.1 , -161.1 , -162.42, -163.56, -165.2 ,
        -166.41, -167.5 , -168.75, -169.57, -171.13, -171.9 , -173.28,
        -174.36, -176.29, -177.55, -179.6 , -181.97, -183.48, -185.44,
        -186.62, -188.67, -189.91, -191.69, -193.89, -195.54, -198.39,
        -200.23, -202.55, -204.54, -207.55, -209.31, -212.26, -215.43,
        -217.7 , -220.63, -222.87, -226.91, -229.13, -232.87, -235.33,
        -238.64, -242.31, -244.73, -247.98, -249.94, -252.52, -254.16,
        -255.16, -255.07, -254.21, -251.26, -248.09, -241.49, -235.79,
        -225.7 , -217.57, -204.67])

    np.allclose(times, t_sim)
    np.allclose(rmw[:,1], ymw)
    np.allclose(vmw[:,1], vymw)
    np.allclose(rlmc[:,1], ylmc)
    np.allclose(vlmc[:,1], vylmc)

